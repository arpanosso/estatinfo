<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Estatística e Informática</title>
    <meta charset="utf-8" />
    <meta name="author" content="Alan Rodrigo Panosso alan.panosso@unesp.br" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Estatística e Informática
## Aula 11 - Estimação
### Alan Rodrigo Panosso <a href="mailto:alan.panosso@unesp.br" class="email">alan.panosso@unesp.br</a>
### Departamento de Engenharia e Ciências Exatas FCAV/UNESP
### (21-07-2022)

---




class: middle, center, inverse

# Conceitos Básicos

---

### Parâmetro e Estatística

**Parâmetro**: é uma medida usada para descrever uma característica da população.


**Estatística** ou **Estimador**: é qualquer função de uma amostra aleatória (fórmula ou expressão), construída com o propósito de servir como instrumento para descrever alguma característica da amostra e para fazer *inferência* a respeito da característica na população.  


Resumo | Parâmetro | Estatística
---|:---:|:---:
Média | `\(\mu\)` | `\(\bar{x}=\frac{1}{n} \sum \limits_{i=1}^n x_i\)`
Variância | `\(\sigma^2\)`| `\(s^2 = \frac{1}{n-1} \sum \limits_{i=1}^n {(x_i - \mu)^2}\)`
Proporção | `\(\pi\)` | `\(\hat{p}= \frac{X}{n}\)`

O valor numérico da estatística ou estimador de um parâmetro, calculado para uma amostra observada, é chamado de **estimativa desse parâmetro**.

A diferença entre estatística e estimativa é que a **estatística** é uma variável aleatória, e a estimativa é um particular valor dessa variável aleatória.


---

## Acurácia  
A acurácia mede quão próximo o valor estimado está do valor real, ou seja, é a habilidade do estimador de estimar o valor real.


## Precisão  
A Precisão mede quão próximas estimativas individuais estão umas das outras, ou seja é a habilidade do estimador de estimar valores similares de maneira consistente.

--

&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/acuracia_precisao.png" width="100%" style="display: block; margin: auto;" /&gt;

---

## Propriedades de um bom estimador

**1) Consistência**: é uma propriedade por meio da qual a acurácia de uma estimativa aumenta quando o tamanho da amostra aumenta. Assim dado um parâmetro populacional `\(\theta\)` e sendo `\(\hat{\theta}\)`  o estimador desse parâmetro. As condições suficientes para um estimador ser consistente são:

`$$\lim_{n \to \infty}E(\hat{\theta}) = \theta$$`

`$$\lim_{n \to \infty}Var(\hat{\theta}) = 0$$`

### Exemplo

`$$E(\bar{X}) = \mu \text{ e } Var(\bar{X})= \frac{Var(X)}{n}$$`

---

## Propriedades de um bom estimador

**2) Não viciado ou não viesado**: O estimador  `\(\hat{\theta}\)`  como uma variável aleatória, tem uma certa distribuição em repetidas amostras de tamanho `\(n\)`. Não viciado é uma propriedade que assegura que, em média, o estimador é correto:

O **estimador** é chamado **não viciado** ou **imparcial** se seu valor esperado ou médio for igual ao verdadeiro valor do parâmetro, ou seja:

`$$E(\hat{\theta}) = \theta$$`

Entretanto, se

`\(E(\hat{\theta}) = \theta + b(\theta)\)` com `\(b(\theta) \neq 0\)`,

o estimador é **viciado** e a quantidade `\(b(\theta)\)` é chamada vício ou viés.

---
### Exemplos de Estimadores

Estes estimadores nada mais são do que as próprias definições dos respectivos parâmetros, mas aplicadas à amostra:

`\(E(\bar{X})=\mu\)` e `\(E(\hat{p}) = p\)`


Por sua vez, para a variância o estimador populacional `\(\sigma^2 = \frac{1}{n} \sum \limits_{i=1}^n (x -\bar{x})^2\)` é viciado, pois, podemos demonstrar que:

`\(E(\hat{\sigma}^2)=\frac{n-1}{n}\sigma^2 = \sigma^2 - \frac{1}{n}\sigma^2\)`

onde o viés `\(b(\sigma^2) = -\frac{1}{n} \sigma^2\)`.

Abaixo segue o estimador não viciado para variância:

`\(s^2 = \frac{1}{n-1} \sum \limits_{i=1}^n (x -\bar{x})^2\)`  

No entanto, para `\(n \to \infty\)`, têm-se para ambos os estimadores convergem para `\(\sigma^2\)`, ou seja, `\(\hat{\sigma}^2\)` e `\(s^2\)` são assintoticamente não viciados.

---
class: middle, inverse, center

# Acesse o Link para estudarmos essas Propriedades

## https://arpanosso.shinyapps.io/estatinfo/


---

class: center,inverse

O vídeo abaixo apresenta os passos utilizados para a construções dos estimadores e dos gráficos apresentados no aplicativo.


&lt;iframe width="718" height="404" src="https://www.youtube.com/embed/g3xrAjJdOx0" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;

[Link do vídeo](https://youtu.be/an0bGEjdWMM)


---
class: middle, center, inverse

# Estimativa por Ponto e por Intervalo

---

### Estimativa por ponto

É a estimativa de um parâmetro populacional dada por um único valor para a estatística, exemplo:


`$$\hat{X} = \mu$$`

esse procedimento não permite julgar qual a possível magnitude do erro que se está cometendo.

**Exemplo**: O diâmetro a altura do peito de árvores de Eucalipto tem uma média de `\(105 \;cm\)`,

---

### Estimativa por intervalo

É a estimativa de um parâmetro populacional baseada na distribuição amostral do estimador pontual, dada por dois valores `\(a\)` e `\(b\)` `\((a &lt; b)\)`, entre os quais se considera que o parâmetro esteja contido.

Essas estimativas indicam a sua precisão ou acurácia, por isto são preferíveis às estimativas por ponto.

A declaração da precisão de uma estimativa por intervalo denomina-se grau de confiança ou **nível de confiança**, daí a denominação de **Intervalo de Confiança**.

**Exemplo**: O diâmetro a altura do peito de árvores de Eucalipto tem uma média de `\(105 \pm 0,05\;cm\)`,

---

class: middle, center, inverse

# Estimativa por Intervalo de Confiança

---

### Estimativa por intervalo de confiança

Um intervalo de confiança para `\(\theta\)` é um intervalo construído a partir das observações da amostra, de modo que ele inclui o verdadeiro e desconhecido valor de `\(\theta\)`, **com uma específica e alta probabilidade** denotada por `\(1 - \alpha\)`, é tipicamente tomada como:

`$$NC = P(a \le \theta \le b) = 1-\alpha$$`

Então, o intervalo `\(] a, b [\)` é chamado intervalo com `\(100 \cdot (1 - \alpha)\%\)` de confiança para o parâmetro `\(\theta\)`, onde: `\(1 ‑ \alpha\)`  é  o **nível de confiança** associado ao intervalo `\(a\)` e `\(b\)` são os **limites de confiança**, inferior e superior, respectivamente, do intervalo.

Onde temos a seguinte relação:

Nível de Confiança (NC) | Nível de significância `\((\alpha)\)`
:---:|:---:
`\(0,90\)` | `\(0,10\)`
`\(0,95\)` | `\(0,05\)`
`\(0,99\)` | `\(0,01\)`


---
class: middle, center, inverse

# Intervalo de Confiança para a Média Populacional `\((\mu)\)`

---

## Precisamos definir 4 casos:

### (a) Caso em que amostras são grandes `\((n \geq 30)\)` e `\(\sigma\)` conhecido;

### (b) Caso em que amostras são grandes `\((n \geq 30)\)` e `\(\sigma\)` desconhecido;

### (c) Caso em que as amostras são pequenas `\((n &lt; 30)\)` `\(\sigma\)` conhecido;

### (d) Caso em que as amostras são pequenas `\((n &lt; 30)\)` e `\(\sigma\)` desconhecido.

---

### (a) Caso em que amostras são grandes `\((n \geq 30)\)` e `\(\sigma\)` conhecido.

O desenvolvimento de intervalos de confiança para `\(\mu\)` é baseado na distribuição amostral de `\(\bar{X}\)` se o tamanho da amostra `\((n)\)` é grande:

`$$Z = \frac{\bar{X}- \mu}{\frac{\sigma}{\sqrt{n}}} \cong N(0,1)$$`


&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_01.png" width="30%" style="display: block; margin: auto;" /&gt;
onde:  
`\(a = \bar{X} - z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\)` e `\(b = \bar{x} + z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}\)`

$$
`\begin{cases}
\frac{\sigma}{\sqrt{n}} = \sigma_{\bar{X}} = \text{erro padrão da média} \\
z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}} = \text{erro da estimativa da média} 
\end{cases}`
$$

---

### Exemplo

Se `\(1 - \alpha = 0,95\)` nesse caso `\(\alpha = 0,05\)`

&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_02.png" width="100%" style="display: block; margin: auto;" /&gt;

---

[Tabela - Normal Padrão](https://github.com/arpanosso/estatinfo/raw/master/docs/TabelaNormalPadrao.pdf) 

&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_03.png" width="75%" style="display: block; margin: auto;" /&gt;

---

Esta expressão, deve ser interpretada do seguinte modo: construídos todos os intervalos da forma `\(\bar{X} \pm 1,96 \sigma_{\bar{X}}\)`, `\(95\%\)` deles conterão `\(\mu\)`. Lembrando  que `\(\mu\)` não é uma variável aleatória, mas um parâmetro, isto é, não é o mesmo que dizer que `\(\mu\)` tem `\(95\%\)` de probabilidade de estar entre os limites indicados.

&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_04.png" width="65%" style="display: block; margin: auto;" /&gt;

---

Então, denotamos o intervalo de confiança como:

`$$IC(\mu;1-\alpha) = ]\bar{x}-z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}};\bar{x}+z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}[$$`

### Exemplo 

Considerando uma amostra de `\(100\)` animais da raça Nelore, onde o peso médio a desmama é `\(171,70 \;kg\)`, encontre um IC de `\(95\%\)` para `\(\mu\)`, supondo que o desvio padrão da população `\((\sigma)\)` seja igual a `\(7,79\;kg\)`.

--

$$IC(\mu;95\%) = ]171,70 \pm 1,96 \frac{7,79}{\sqrt{100}} $$
`$$IC(\mu;95\%) = ]170,17\;kg; 173,23\;kg [$$`
---

### (b) Caso em que amostras são grandes `\((n \geq 30)\)` e `\(\sigma\)` desconhecido.

Como `\(n\)` é grande, a substituição de `\(\sigma\)` pelo desvio padrão amostral `\((s)\)` não afeta apreciavelmente a estimativa de `\(IC\)`, assim, temos que:


`$$IC(\mu;1-\alpha) = ]\bar{x}-z_{\frac{\alpha}{2}} \frac{s}{\sqrt{n}};\bar{x}+z_{\frac{\alpha}{2}} \frac{s}{\sqrt{n}}[$$`

---

### (c) Caso em que as amostras são pequenas `\((n &lt; 30)\)` e `\(\sigma\)` conhecido.

Se `\(X_1, X_2, \cdots, X_n\)` é uma amostra aleatória de uma população com distribuição normal `\(N (\mu, \sigma^2)\)`, a média amostral `\(\bar{X}\)` é exatamente distribuída como `\(N (\mu, \frac{\sigma^2}{n} )\)`. Sendo `\(\sigma\)` conhecido, o `\(IC (\mu : 1–\alpha)\)` é dado por:

`$$IC(\mu;1-\alpha) = ]\bar{x}-z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}};\bar{x}+z_{\frac{\alpha}{2}} \frac{\sigma}{\sqrt{n}}[$$`

---

class: center,inverse

O vídeo abaixo apresenta um resumos dos `\(3\)` primeiros casos.


&lt;iframe width="718" height="404" src="https://www.youtube.com/embed/JIivixTT344" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;

[Link do vídeo](https://youtu.be/JIivixTT344)

---

### (d) Caso em que as amostras são pequenas `\((n &lt; 30)\)` e `\(\sigma\)` desconhecido.

Fato que ocorre na maioria dos casos, uma aproximação intuitiva é substituir `\(\sigma\)` por `\(s\)` considerar a razão:

`$$t = \frac{\bar{x} - \mu}{\frac{s}{\sqrt{n}}}$$`

Essa substituição causa uma considerável diferença se a amostra for pequena. A notação `\(t\)` é requerida porque `\(s\)` aumenta a variância de `\(t\)` para um valor maior do que um `\((1)\)`, de modo que a razão não é padronizada. 


A distribuição da razão `\(t\)` é conhecida como **distribuição `\(t\)` de Student** com parâmetro `\(r = n – 1\)` graus de liberdade.


---

### Distribuição t de Student

[Tabela - Distribuição t-Student](https://github.com/arpanosso/estatinfo/raw/master/docs/Tabela_tdeStudent.pdf) 

&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_05.png" width="60%" style="display: block; margin: auto;" /&gt;

---

### Distribuição t de Student

As distribuições `\(t\)` são simétricas em torno de zero mas têm caudas mais espalhadas do que a distribuição `\(N(0, 1)\)`. Entretanto, com o aumento de `\(r\)`, a distribuição `\(t\)` se aproxima da distribuição `\(N(0, 1)\)`, por `\(Var(t)\)` tende à unidade `\((1)\)`.

`$$E(t) = 0$$`
e
`$$Var(t) = \frac{r}{r-2} = \frac{n-1}{n-3}$$`

Pode-se concluir da distribuição `\(t\)`, que

`$$P(-t_{\frac{\alpha}{2}} \le \frac{\bar{x}-\mu}{\frac{s}{\sqrt{n}}} \le +t_{\frac{\alpha}{2}}) = 1 - \alpha$$`
em que `\(t_{\alpha \\2}\)` é obtido na tabela da distribuição `\(t\)` com `\(r = n – 1\)` graus de liberdade, ou seja:

`$$IC(\mu;1-\alpha) = ]\bar{x}-t_{\frac{\alpha}{2}} \frac{s}{\sqrt{n}};\bar{x}+t_{\frac{\alpha}{2}} \frac{s}{\sqrt{n}}[$$`

---
class: center,inverse

O vídeo abaixo apresenta um resumos do último caso apresentado.


&lt;iframe width="718" height="404" src="https://www.youtube.com/embed/awuOPux5D1A" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;

[Link do vídeo](https://youtu.be/awuOPux5D1A)

---
### Exercício

Uma amostra de `\(10\)` cães sofrendo de uma determinada doença apresentou um tempo de sobrevivência médio de `\(46,9\)` meses e o desvio padrão de `\(43,3\)` meses. Determinar os limites de confiança de `\(90\%\)` para `\(\mu\)`.

--

&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_06.png" width="80%" style="display: block; margin: auto;" /&gt;

---

class: middle, center, inverse

# Intervalo de Confiança para o Parâmetro Binomial `\((p)\)`

---

Fazendo uso do fato que, para `\(n\)` grande, a distribuição binomial pode ser aproximada com a normal:

`$$Z = \frac{x - n.p}{\sqrt{n.p.(1-p)}}$$`

Temos:

`$$P \left(-z_{\frac{\alpha} {2}} \le \frac{x- np}{\sqrt{np(1-p)}} \le +z_{\frac{\alpha}{2}} \right) = 1 - \alpha$$`

Substituindo `\(p\)`, visto que é desconhecido, por seu estimador `\(\hat{p}\)`  dentro das raízes, obtêm-se:

`$$IC(\hat{p};1-\alpha) = \left]\hat{p}-z_{\frac{\alpha}{2}} \sqrt{\frac{\hat{p}\hat{q}}{n}};\hat{p}+z_{\frac{\alpha}{2}} \sqrt{\frac{\hat{p}\hat{q}}{n}} \right[$$`

---

### Exemplo

Suponha que em `\(n = 400\)` animais são administrados uma droga, obtendo  `\(X = 320\)` sucessos, ou seja, `\(80\%\)` dos animais melhoraram.  A partir destes dados, obtenha um `\(IC\)` para `\(p\)`, com `\(1 - \alpha = 0,90\)`.


&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_07.png" width="65%" style="display: block; margin: auto;" /&gt;

---

### Exemplo  
Suponha que em `\(n = 400\)` animais doentes são administrados uma droga, obtendo  `\(X = 320\)` sucessos, ou seja, `\(80\%\)` dos animais melhoraram.  A partir destes dados, obtenha um `\(IC\)` para `\(p\)`, com `\(1 - \alpha = 0,90\)`.


&lt;img src="https://raw.githubusercontent.com/arpanosso/estatinfo/master/slides/img/ic_08.png" width="60%" style="display: block; margin: auto;" /&gt;

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
