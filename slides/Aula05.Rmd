---
# Para transformar em PDF, usar: 
# pagedown::chrome_print("slides/Aula05.html")
# imagens https://www.pexels.com/pt-br/
# gifs https://giphy.com/
title: "Estatística e Informática"
subtitle: "Aula 05 - Medidas Estatísticas"
author: "Alan Rodrigo Panosso <alan.panosso@unesp.br>"
institute: "Departamento de Engenharia e Ciências Exatas FCAV/UNESP"
date: "(13-05-2021)"
encoding: "UTF-8"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      ratio: "16:9"
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
knitr::opts_chunk$set(echo=TRUE, message = FALSE, warning = FALSE, comment = "#>", fig.align = "center")
options(dplyr.print_min = 5, dplyr.print_max = 5)
```
class: middle, center, inverse

# Medidas de Posição ou de Tendência Central

---
## Medidas de posição

São respostas breves e rápidas que sintetizam a informação não de uma forma de completa descrição dos dados ou eventual modelagem. 

Essas medidas, portanto, fornecem a posição na reta real, informa sobre a posição de um conjunto de dados. As Principais medidas são: 

1. Média:  
 - **Aritmética**
 - Ponderada
 - Geométrica (Apostila Apenas)
 - Harmônica (Apostila Apenas)

2. Mediana 

3. Moda

---
### Média Populacional

Para a população, a média é definida como:

 $$
 \mu = \frac{\sum \limits_{i=1}^N x_i} {N}, \text{com } i=1,2,...,N.
 $$
 
 Onde $N$ é o tamanho da população (e geralmente não a conhecemos). 


### Média amostral

 É a mais utilizada das medidas de posição. A média aritmética de um conjunto de $n$ observações da variável aleatória $X$, é o quociente da divisão por $n$ da soma dos valores das observações dessa variável. A média amostral $\bar{x}$ é a estimativa mais **eficiente**, **imparcial** e **consistente** da média da população $\mu$. 
 
 $$
 \bar{x} = \frac{\sum \limits_{i=1}^nx_i} {n}, com\; i=1,2,...,n.
 $$
Onde $n$ é o tamanho da amostra.
---

O exemplo abaixo demonstra o cálculo da média da amostra da idade em anos de 49 alunos (`idade_anos`). Observe que a média tem as mesmas unidades de medida que as observações individuais. 

**Exemplo**: Para os dados de `idade_anos`, da base de [Dados](https://arpanosso.github.io/estatinfo/data/dados_turmas.xlsx) da turma os valores de média.

**Carregando Pacotes e a Base de Dados**

```{r, eval=FALSE}
library(readxl)
library(tidyverse)
dados_turmas <- read_excel("C:/Users/Usuario/Downloads/dados_turmas.xlsx")
View(dados_turmas)
```

```{r,echo=FALSE}
`%>%` <- magrittr::`%>%`
library(dplyr)
library(tidyr)
library(ggplot2)
library(readxl)
dados_turmas <- read_excel("../data/dados_turmas.xlsx")
```

```{r,out.width = "50%",fig.cap="",fig.align = 'center',echo=FALSE}
knitr::include_graphics("https://arpanosso.github.io/estatinfo/slides/img/importa_r4.png")
```

---

### Cálculo da Média Aritmética 

.pull-left[

$$
\bar{x} = \frac{\sum_{i=1}^nx_i}{n} = \frac{19+20+ \cdots+20}{49} = 20,9184\text{ anos} 
$$

```{r}
x<-dados_turmas$idade_anos
mean(x)
```

### Cálculo da Média Aritmética pela Frequência Relativa

$\bar{x} = \sum_{i=1}^kf_ix_i$

$\bar{x} = 18(0,16)+19(0,28)+ \cdots + 49(0,02)$

$\bar{x} = 20,9184\;anos$

]

.pull-right[

Tabela de Frequência para Idade

```{r,echo=FALSE}
tab<-dados_turmas %>%
        group_by(idade_anos) %>% 
        summarise(ni=n()) %>%      
        mutate(fi = ni/sum(ni))
kableExtra::kable(tab)
```
]
---
**Hitograma e média para idade_anos**
.pull-left[
```{r,plot13_1, eval=FALSE}
dados_turmas %>% 
  ggplot(aes(x=idade_anos, y=..density..)) +
  geom_histogram(bins=10, 
                 color="black", 
                 fill="gray")+
  geom_vline(xintercept = 20.9184, #<<
             color="blue") #<<
```

Se os dados são plotados como um histograma a média é o centro de gravidade do histograma (linha azul). 

Ou seja, se o histograma fosse feito de um material sólido, ele se equilibraria horizontalmente com o ponto de apoio em $\bar{x}$. 

A média é aplicável aos dados de quantitativos, e **não deve ser usado para dados ordinais e nominais**.

]

.pull-left[

```{r,plot13_1, echo=FALSE}
```
]

---

**Hitograma e média para altura**

.pull-left[

```{r}
mean(dados_turmas$altura)
```


```{r,plot13_2, eval=FALSE}
dados_turmas %>% 
  ggplot(aes(x=altura, y=..density..)) +
  geom_histogram(bins=6, 
                 color="black", 
                 fill="gray")+
  geom_vline(
    xintercept = 1.7242, #<<
    color="blue") #<<
```

$\bar{x} = \frac{1,98+1,59+ \cdots+1,78}{49}$

$\bar{x} =  1,724\text{ m}$

]

.pull-left[

```{r,plot13_2, echo=FALSE}
```
]
Observe o histograma e a média para a variável `altura`, e compare sua simetria com o histograma da variável `idade_anos`.
---

## Mediana

É o valor que ocupa a posição central do conjunto de dados ordenados $(X' \text{ ou } Xo)$. Portanto, inicialmente as observações são ordenadas de acordo com a sua ordem de magnitude.

o valor da mediana é precedido e seguido pelo mesmo  número de observações. E a mediana amostral é a melhor estimativa da mediana populacional quando o número e observações é grande.

A mediana será encontrada ou calculada em função do número de observações $n$ presentes na base de dados, se acaso $n$ for par ou ímpar:

Se $n$ é ímpar: $Md = Xo_{\left(\frac{n+1}{2}\right)}$

Se $n$ é par: $Md = \frac{ Xo_{\left(\frac{n}{2} \right) } + Xo_{\left(\frac{n}{2} +1\right) } }{2}$
---

**Exemplo 1**:  

Dado $X=\{50, 60, 20, 50, 30, 90, 70\}$, teremos a sua versão ordenada $X_0$ dada por:

$X_o=\{20, 30, 50, 50, 60, 70 ,90 \}$, então,

$n=7$, ímpar.

$Md = Xo_{\left(\frac{n+1}{2}\right)} = Xo_{\left(\frac{7+1}{2}\right)} =Xo_{4} = 50$

.pull-left[
No R:
```{r}
X=c(20, 30, 50, 50, 60, 70 ,90)
median(X)
```
Observe que a unidade da mediana é a mesma dos dados individuais.

]

.pull-right[
No Excel:

```{r,out.width = "70%",fig.cap="",fig.align = 'center',echo=FALSE}
knitr::include_graphics("https://arpanosso.github.io/estatinfo/slides/img/mediana_excel.png")
```
]

---

### Media e Mediana

Em uma distribuição simétrica (como a da variável `altura`), a mediana amostral também é uma estimativa imparcial e consistente de média populacional $\mu$, contudo não é tão eficiente como a média amostral $\bar{x}$.

.pull-left[

```{r}
median(dados_turmas$altura)
```


```{r,plot13_3, eval=FALSE}
dados_turmas %>% 
  ggplot(aes(x=altura, y=..density..)) +
  geom_histogram(bins=6, 
                 color="black", 
                 fill="gray")+
  geom_vline(
    xintercept = c(1.7242,1.74), #<<
    color=c("blue","red")) #<<
```

$Md =  1,74\text{ m}$

Se a distribuição de frequência é assimétrica (como a da variável `idade_anos`) a mediana é uma pobre estimativa da média populacional.
]

.pull-left[

```{r,plot13_3, echo=FALSE}
```


]

---

**Exemplo 2**: Calcular a média e a mediana dos dados de salário (nº salário mínimos), que diz respeito à uma amostra de 6 colaboradores de uma empresa.

$$S=\{ 5, 2, 3, 6, 10, 9\}$$
$n=6$, par.

$$Md = \frac{ Xo_{\left(\frac{n}{2} \right) } + Xo_{\left(\frac{n}{2} +1\right) } }{2}$$

Assim, para os dados de salários temos:

Vetor ordenado: $So=\{ 2, 3, 5, 6, 9, 10\}$, então a mediana será dada por:

$Md = \frac{ Xo_{\left(\frac{n}{2} \right) } + Xo_{\left(\frac{n}{2} +1\right) } }{2} = \frac{ Xo_{\left(3 \right) } + Xo_{\left(4\right) } }{2}= \frac{ 5 + 6}{2} = 5,5 \text{ salários mínimos}$.

A média será dada por:

$\bar{x}= \frac{2+3+5+6+9+10}{6} = 5,83 \text{ salários mínimos}$

---

Imagine que, ao ínvés de 10, o verdadeiro valor de ganho do 5º colaborador amostra seja 100, calcule a média e a mediana novamente para essa variável: 

$$S=\{ 5, 2, 3, 6, 100, 9\}$$
$n=6$, par.

$$Md = \frac{ Xo_{\left(\frac{n}{2} \right) } + Xo_{\left(\frac{n}{2} +1\right) } }{2}$$

Assim, para os dados de salários temos:

Vetor ordenado: $So=\{ 2, 3, 5, 6, 9, 100\}$, então a mediana será dada por:

$Md = \frac{ Xo_{\left(\frac{n}{2} \right) } + Xo_{\left(\frac{n}{2} +1\right) } }{2} = \frac{ Xo_{\left(3 \right) } + Xo_{\left(4\right) } }{2}= \frac{ 5 + 6}{2} = 5,5 \text{ salários mínimos}$.

A média será dada por:

$\bar{x}= \frac{2+3+5+6+9+100}{6} = 20,83 \text{ salários mínimos}$

Concluímos então que a mediana não é afetada por observações muito grandes ou muito pequenas, enquanto que a presença de tais extremos tem um significante efeito sobre a média.

---

## Moda
.pull-left[
A moda é comumente definida como a medição que ocorre com mais frequência em um conjunto de dados.

Para os dados de `idade_anos` o valor mais presente do conjunto de dados é 19 anos.

Portanto, podemos ter distribuições com mais de um valor mais frequente (plurimodal), ou mesmo sem moda (amodal).

Outra forma de definir a moda como uma medida de concentração relativamente grande, pois algumas distribuições de frequência podem ter mais de um ponto de concetração, embora essas concentrações possam não conter precisamente as mesmas frequências.

]

.pull-right[

```{r,plot13_1, echo=FALSE}
```
]
---


```{r}
x<-c(6, 7, 7, 8, 8, 8, 8, 8, 8, 9, 9, 10, 11, 12, 12, 12, 12, 12, 13, 13, 14)
tibble(x) %>% 
  ggplot(aes(x=x,y=..density..)) +
  geom_histogram(bins = 9,
                 color="black",
                 fill="lightgray")
```

---
## Quantis
É a extensão da noção de mediana, ou seja, são observações que dividem o conjunto ordenado de dados. 

- Os Quantis de ordem $25$, $50$, $75$ são chamados **Quartis** (Q1, Q2, Q3).  Naturalmente, Q2 = mediana (Md). 

- Os **Decis** são os quantis de ordem $10$, $20$, ..., $90$  (D1, D2, ..., D9)

- Os **Percentis** são os quantis de ordem $1$, $2$, ..., $99$ (P1, P2, ..., P99).

No R, ele podem ser encontrados por meio da função `quantile()` que tem como algumento o vetor de dados e a proporção dos dados acumulada até o respectivo valor.

.pull-left[
```{r}
altura<-dados_turmas$altura
q1 <- quantile(altura,0.25)
q2 <- quantile(altura,0.50)
q3 <- quantile(altura,0.75)
```
A função `geom_vline()`, ao lado, cria as linhas verticais na posição dos respectivos quartis no gráfico a seguir.
]

.pull-right[
```{r,plot14,eval=FALSE}
dados_turmas %>% 
  ggplot(aes(x=altura,y=..density..)) +
  geom_histogram(bins=6,
                 col="black",
                 fill="gray") +
  geom_vline(xintercept=c(q1,q2,q3), #<<
             color="red",lwd=1,
             linetype=2)+ 
  theme_bw()
```
]
---
```{r,plot14,echo=FALSE}
```

---
class: middle, center, inverse

# Medidas de Dispersão ou de Variabilidade

---

**Medidas de Dispersão**: 

O resumo de um conjunto de dados, por meio de uma única medida representativa de posição central, esconde toda informação sobre a variabilidade do conjunto de valores. 

As medidas de variação medem o grau com que os dados tendem a se distribuir em torno de um valor central. 

- Amplitude total
- Variância 
- Desvio Padrão
- Erro Padrão da Média 
- Coeficiente de Variação

**Coeficientes de formas de distribuição**:
- Coeficiente de Assimetria
- Coeficiente de Curtose 

---

**Exemplo**:

Dados o conjunto de 4 amostras da mesma variável (altura de planta em cm), calcule a média e a Amplitude amplitude total de cada amostra.

```{r,echo=FALSE}
X1<-c(9,9,9,9,9)
X2<-c(7,8,9,10,11)
X3<-c(0.6,3.4,9.8,13.8,17.4)
X4<-c(0.6,9,9,9,17.4)
tibble(X1,X2,X3,X4) %>% 
  kableExtra::kable()
```
--
Tabela de Médias

```{r,echo=FALSE}
X1<-c(9,9,9,9,9)
X2<-c(7,8,9,10,11)
X3<-c(0.6,3.4,9.8,13.8,17.4)
X4<-c(0.6,9,9,9,17.4)
tibble(X1,X2,X3,X4) %>% 
  summarise( 
    media_x1 = mean(X1),
    media_x2 = mean(X2),
    media_x3 = mean(X3),
    media_x4 = mean(X4)
  )%>% 
  kableExtra::kable()
```

--
Tabela de Amplitudes Totais

```{r,echo=FALSE}
X1<-c(9,9,9,9,9)
X2<-c(7,8,9,10,11)
X3<-c(0.6,3.4,9.8,13.8,17.4)
X4<-c(0.6,9,9,9,17.4)
tibble(X1,X2,X3,X4) %>% 
  summarise( 
    Delta_x1 = diff(range(X1)),
    Delta_x2 = diff(range(X2)),
    Delta_x3 = diff(range(X3)),
    Delta_x4 = diff(range(X4))
  )%>% 
  kableExtra::kable()
```
